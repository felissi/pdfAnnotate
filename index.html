<!-- index.htm -->
<html>
        <head>
                <script src="https://unpkg.com/vanilla-picker@2"></script>
                <script src="./_bundles/pdfAnnotate.js" async></script>
                <style>
.buttonClass {
        margin-top: 5px;
        margin-bottom: 5px;
}
                </style>
        </head>
        <body>
                <div id="app"></div>
                <hr>
                Filename:<input style="margin-left: 10px;" type="text" id="inputFileName" value="./test_documents/test2.pdf">
                <button id="reloadFile" type="button">Reload</button>
                <hr>
                <div> <button id="textAnnotColorPicker">Choose Color</button>
                        <input type="checkbox" id="textAnnotOpen" name="textAnnotOpen"><label for="textAnnotOpen">Open?</label>
                        <p>
                        Opacity:<input style="margin-left: 10px;" type="number" id="textAnnotOpacity" value="0.5">
                        </p>
                        <p>
                        Icon:
                        <fieldset>
                                <input type="radio" id="comment" name="icon">
                                <label for="comment">Comment</label>
                                <input type="radio" id="Key" name="icon">
                                <label for="Key">Key</label>
                                <input type="radio" id="Note" name="icon" checked>
                                <label for="comment">Note</label>
                                <input type="radio" id="help" name="icon">
                                <label for="help">Help</label>
                                <input type="radio" id="newpar" name="icon">
                                <label for="newpar">New Paragraph</label>
                                <input type="radio" id="par" name="icon">
                                <label for="par">Paragraph</label>
                                <input type="radio" id="insert" name="icon">
                                <label for="insert">Insert</label>
                        </fieldset>
                        </p>
                        StateModel:
                        <fieldset>
                                <input type="radio" id="marked" name="stateModel">
                                <label for="marked">Marked</label>
                                <input type="radio" id="review" name="stateModel">
                                <label for="review">Review</label>
                        </fieldset>
                        </p>
                        </p>
                        State:
                        <fieldset>
                                <input type="radio" id="_marked" name="state">
                                <label for="_marked">Marked</label>
                                <input type="radio" id="unmarked" name="state">
                                <label for="unmarked">Unmarked</label>
                                <input type="radio" id="accepted" name="state">
                                <label for="accepted">Accepted</label>
                                <input type="radio" id="rejected" name="state">
                                <label for="rejected">Rejected</label>
                                <input type="radio" id="cancelled" name="state">
                                <label for="cancelled">Cancelled</label>
                                <input type="radio" id="completed" name="state">
                                <label for="completed">Completed</label>
                                <input type="radio" id="none" name="state">
                                <label for="none">None</label>
                        </fieldset>
                        </p>
                </div>
                <div class="buttonClass"><button id="addTextAnnotation" type="button">Create Text Annotation</button></div>
                <hr>
                <div> <button id="highlightAnnotColorPicker">Choose Color</button>
                        <p>
                        Opacity:<input style="margin-left: 10px;" type="number" id="highlightAnnotOpacity" value="0.5">
                        </p>
                </div>
                <div class="buttonClass"><button id="addHighlightAnnotation" type="button">Create Highlight Annotation</button></div>
                <div class="buttonClass"><button id="addHighlightAnnotationQuadPoint" type="button">Create Highlight Annotation QuadPoint</button></div>
                <div class="buttonClass"><button id="addHighlightAnnotationQuadPointWithoutRect" type="button">Create Highlight Annotation QuadPoint without Rect Definition</button></div>
                <div class="buttonClass"><button id="addUnderlineAnnotation" type="button">Create Underline Annotation</button></div>
                <div class="buttonClass"><button id="addSquigglyAnnotation" type="button">Create Squiggly Annotation</button></div>
                <div class="buttonClass"><button id="addStrikeOutAnnotation" type="button">Create StrikeOut Annotation</button></div>
                <hr>
                <p>
                Text justification:
                <fieldset>
                        <input type="radio" id="left" name="freetext_text_justification" checked>
                        <label for="left">Left</label>
                        <input type="radio" id="center" name="freetext_text_justification">
                        <label for="center">Center</label>
                        <input type="radio" id="right" name="freetext_text_justification">
                        <label for="right">Right</label>
                </fieldset>
                </p>
                <p>
                Freetext type:
                <fieldset>
                        <input type="radio" id="freetext" name="freetext_type" checked>
                        <label for="freetext">Freetext</label>
                        <input type="radio" id="freetext_callout" name="freetext_type">
                        <label for="freetext_callout">FreeTextCallout</label>
                        <input type="radio" id="freetext_typewriter" name="freetext_type">
                        <label for="freetext_typewriter">FreeTextTypeWriter</label>
                </fieldset>
                </p>
                Callout line ending:
                <fieldset>
                        <input type="radio" id="square" name="freetext_callout_line_ending">
                        <label for="square">Square</label>
                        <input type="radio" id="circle" name="freetext_callout_line_ending">
                        <label for="circle">Circle</label>
                        <input type="radio" id="diamond" name="freetext_callout_line_ending">
                        <label for="diamond">Diamond</label>
                        <input type="radio" id="open_arrow" name="freetext_callout_line_ending">
                        <label for="open_arrow">OpenArrow</label>
                        <input type="radio" id="closed_arrow" name="freetext_callout_line_ending">
                        <label for="closed_arrow">ClosedArrow</label>
                        <input type="radio" id="none" name="freetext_callout_line_ending" checked>
                        <label for="none">None</label>
                        <input type="radio" id="butt" name="freetext_callout_line_ending">
                        <label for="butt">Butt</label>
                        <input type="radio" id="r_open_arrow" name="freetext_callout_line_ending">
                        <label for="r_open_arrow">ROpenArrow</label>
                        <input type="radio" id="r_closed_arrow" name="freetext_callout_line_ending">
                        <label for="r_closed_arrow">RClosedArrow</label>
                        <input type="radio" id="slash" name="freetext_callout_line_ending">
                        <label for="slash">Slash</label>
                </fieldset>
                </p>
                <div class="buttonClass"><button id="addFreeTextAnnotation" type="button">Create FreeText Annotation</button></div>
                <div class="buttonClass"><button id="addLineAnnotation" type="button">Create Line Annotation</button></div>
                <hr>
                <div> <button id="lineColorPicker">Choose Line Color</button><button id="fillColorPicker">Choose Fill Color</button></div>
                <div class="buttonClass"><button id="addCircleAnnotation" type="button">Create Circle Annotation</button></div>
                <div class="buttonClass"><button id="addSquareAnnotation" type="button">Create Square Annotation</button></div>
                <div class="buttonClass"><button id="addPolygonAnnotation" type="button">Create Polygon Annotation</button></div>
                <p>
                Start line ending:
                <fieldset>
                        <input type="radio" id="square" name="polyline_line_start">
                        <label for="square">Square</label>
                        <input type="radio" id="circle" name="polyline_line_start">
                        <label for="circle">Circle</label>
                        <input type="radio" id="diamond" name="polyline_line_start">
                        <label for="diamond">Diamond</label>
                        <input type="radio" id="open_arrow" name="polyline_line_start">
                        <label for="open_arrow">OpenArrow</label>
                        <input type="radio" id="closed_arrow" name="polyline_line_start">
                        <label for="closed_arrow">ClosedArrow</label>
                        <input type="radio" id="none" name="polyline_line_start" checked>
                        <label for="none">None</label>
                        <input type="radio" id="butt" name="polyline_line_start">
                        <label for="butt">Butt</label>
                        <input type="radio" id="r_open_arrow" name="polyline_line_start">
                        <label for="r_open_arrow">ROpenArrow</label>
                        <input type="radio" id="r_closed_arrow" name="polyline_line_start">
                        <label for="r_closed_arrow">RClosedArrow</label>
                        <input type="radio" id="slash" name="polyline_line_start">
                        <label for="slash">Slash</label>
                </fieldset>
                </p>
                <p>
                End line ending:
                <fieldset>
                        <input type="radio" id="square" name="polyline_line_end">
                        <label for="square">Square</label>
                        <input type="radio" id="circle" name="polyline_line_end">
                        <label for="circle">Circle</label>
                        <input type="radio" id="diamond" name="polyline_line_end">
                        <label for="diamond">Diamond</label>
                        <input type="radio" id="open_arrow" name="polyline_line_end">
                        <label for="open_arrow">OpenArrow</label>
                        <input type="radio" id="closed_arrow" name="polyline_line_end">
                        <label for="closed_arrow">ClosedArrow</label>
                        <input type="radio" id="none" name="polyline_line_end" checked>
                        <label for="none">None</label>
                        <input type="radio" id="butt" name="polyline_line_end">
                        <label for="butt">Butt</label>
                        <input type="radio" id="r_open_arrow" name="polyline_line_end">
                        <label for="r_open_arrow">ROpenArrow</label>
                        <input type="radio" id="r_closed_arrow" name="polyline_line_end">
                        <label for="r_closed_arrow">RClosedArrow</label>
                        <input type="radio" id="slash" name="polyline_line_end">
                        <label for="slash">Slash</label>
                </fieldset>
                </p>
                <div class="buttonClass"><button id="addPolyLineAnnotation" type="button">Create PolyLine Annotation</button></div>
                <hr>
                <div class="buttonClass"><button id="addInkAnnotation" type="button">Create Ink Annotation</button></div>
                <div class="buttonClass"><button id="addFreeHighlightAnnotation" type="button">Create Free Highlight Annotation</button></div>
                <div class="buttonClass"><button id="download" type="button">Download</button></div>
                <div class="buttonClass"><button id="showAnnotations" type="button">Show Annotations</button></div>
                <div id="toDelete"></div>
                <div class="buttonClass"><button id="deleteAnnotation" type="button">Delete Annotation</button></div>
                <script>

                        var textAnnotColor = {r : 0, g : 0, b : 0}
                                                var highlightAnnotColor = {r : 0, g : 0, b : 0}
                                                var lineColor = {r : 0, g : 0, b : 0}
                                                var fillColor = {r : 0, g : 0, b : 0}

                                                var textAnnotColorPicker = document.querySelector('#textAnnotColorPicker');
                                                var _textAnnotColorPicker = new Picker(textAnnotColorPicker);

                                                _textAnnotColorPicker.onChange = function(color) {
                                                                                textAnnotColorPicker.style.background = color.rgbaString;
                                                                                textAnnotColor = {r: color._rgba[0], g: color._rgba[1], b: color._rgba[2]}
                                                                        };

                                                var highlightAnnotColorPicker = document.querySelector('#highlightAnnotColorPicker');
                                                var _highlightAnnotColorPicker = new Picker(highlightAnnotColorPicker);

                                                _highlightAnnotColorPicker.onChange = function(color) {
                                                                                highlightAnnotColorPicker.style.background = color.rgbaString;
                                                                                highlightAnnotColor = {r: color._rgba[0], g: color._rgba[1], b: color._rgba[2]}
                                                                        };


                                                var lineColorPicker = document.querySelector('#lineColorPicker');
                                                var _lineColorPicker = new Picker(lineColorPicker);

                                                _lineColorPicker.onChange = function(color) {
                                                                                lineColorPicker.style.background = color.rgbaString;
                                                                                lineColor = {r: color._rgba[0], g: color._rgba[1], b: color._rgba[2]}
                                                                        };

                                                var fillColorPicker = document.querySelector('#fillColorPicker');
                                                var _fillColorPicker = new Picker(fillColorPicker);

                                                _fillColorPicker.onChange = function(color) {
                                                                                fillColorPicker.style.background = color.rgbaString;
                                                                                fillColor = {r: color._rgba[0], g: color._rgba[1], b: color._rgba[2]}
                                                                        };

                                                let pdfFactory = undefined

                                                let fileLoad = function (filepath) {
                                                                                console.log("Load " + filepath)

                                                                                pdfAnnotate.AnnotationFactory.loadFile(filepath, "123", "123").then((factory) => {
                                                                                                                //pdfAnnotate.AnnotationFactory.loadFile(filepath).then((factory) => {
                                                                                                                pdfFactory = factory
                                                                                                                console.log(factory)
                                                                                                        })
                                                                        }

                                                document.querySelector('#deleteAnnotation').addEventListener('click', (evt) => {
                                                                                pdfFactory.getAnnotations().then( (data) => {
                                                                                                                for (let annot of data[0]) {
                                                                                                                                                var btn = document.createElement("BUTTON")
                                                                                                                                                btn.addEventListener('click', (evt) => {
                                                                                                                                                                                let id = annot.id
                                                                                                                                                                                pdfFactory.deleteAnnotation(id)
                                                                                                                                                                        })
                                                                                                                                                var t = document.createTextNode(annot.id)
                                                                                                                                                btn.appendChild(t);
                                                                                                                                                document.querySelector('#toDelete').appendChild(btn)
                                                                                                                                        }
                                                                                                                console.log(data)
                                                                                                        })
                                                                        })

                                                function getRadioButtonIcon() {
                                                                                let radios = document.getElementsByName("icon")

                                                                                if (radios[0].checked) {
                                                                                                                return pdfAnnotate.AnnotationIcon.Comment
                                                                                                        } else if (radios[1].checked){
                                                                                                                                        return pdfAnnotate.AnnotationIcon.Key
                                                                                                                                } else if (radios[2].checked){
                                                                                                                                                                return pdfAnnotate.AnnotationIcon.Note
                                                                                                                                                        } else if (radios[3].checked){
                                                                                                                                                                                        return pdfAnnotate.AnnotationIcon.Help
                                                                                                                                                                                } else if (radios[4].checked){
                                                                                                                                                                                                                return pdfAnnotate.AnnotationIcon.NewParagraph
                                                                                                                                                                                                        } else if (radios[5].checked){
                                                                                                                                                                                                                                        return pdfAnnotate.AnnotationIcon.Paragraph
                                                                                                                                                                                                                                } else if (radios[6].checked){
                                                                                                                                                                                                                                                                return pdfAnnotate.AnnotationIcon.Insert
                                                                                                                                                                                                                                                        }
                                                                        }

                                                function getStateModel() {
                                                                                let radios = document.getElementsByName("stateModel")
                                                                                if (radios[0].checked) {
                                                                                                                return pdfAnnotate.AnnotationStateModel.Marked
                                                                                                        } else if (radios[1].checked){
                                                                                                                                        return pdfAnnotate.AnnotationStateModel.Review
                                                                                                                                }

                                                                                return undefined
                                                                        }

                                                function getState() {
                                                                                let radios = document.getElementsByName("state")

                                                                                if (radios[0].checked) {
                                                                                                                return pdfAnnotate.AnnotationState.Marked
                                                                                                        } else if (radios[1].checked){
                                                                                                                                        return pdfAnnotate.AnnotationState.Unmarked
                                                                                                                                } else if (radios[2].checked){
                                                                                                                                                                return pdfAnnotate.AnnotationState.Accepted
                                                                                                                                                        } else if (radios[3].checked){
                                                                                                                                                                                        return pdfAnnotate.AnnotationState.Rejected
                                                                                                                                                                                } else if (radios[4].checked){
                                                                                                                                                                                                                return pdfAnnotate.AnnotationState.Cancelled
                                                                                                                                                                                                        } else if (radios[5].checked){
                                                                                                                                                                                                                                        return pdfAnnotate.AnnotationState.Completed
                                                                                                                                                                                                                                } else if (radios[6].checked){
                                                                                                                                                                                                                                                                return pdfAnnotate.AnnotationState.None
                                                                                                                                                                                                                                                        }

                                                                                return undefined
                                                                        }

                                                document.querySelector('#addTextAnnotation').addEventListener('click', (evt) => {
                                                                                let val = {
                                                                                                                page: 0,
                                                                                                                rect: [50, 50, 80, 80],
                                                                                                                contents: "Test123",
                                                                                                                author: "John",
                                                                                                                color: textAnnotColor,
                                                                                                                open: document.getElementById("textAnnotOpen").checked,
                                                                                                                icon: getRadioButtonIcon(),
                                                                                                                opacity: document.getElementById("textAnnotOpacity").value,
                                                                                                                creationDate: new Date(),
                                                                                                                subject: "A subject",
                                                                                                                richtextString: "A very rich text string"
                                                                                                        }
                                                                                let state = getState()

                                                                                if (state) {
                                                                                                                val.state = state
                                                                                                        }

                                                                                let statemodel = getStateModel()

                                                                                if (statemodel) {
                                                                                                                val.stateModel = statemodel
                                                                                                        }
                                                                                pdfFactory.createTextAnnotation(val)
                                                                        })

                                                document.querySelector('#addHighlightAnnotation').addEventListener('click', (evt) => {
                                                                                pdfFactory.createHighlightAnnotation({
                                                                                                                page: 0,
                                                                                                                rect: [100, 100, 200, 200],
                                                                                                                contents: "Test123",
                                                                                                                author: "John",
                                                                                                                color: highlightAnnotColor,
                                                                                                                opacity: document.getElementById("highlightAnnotOpacity").value,
                                                                                                        })
                                                                        })

                                                document.querySelector('#addHighlightAnnotationQuadPoint').addEventListener('click', (evt) => {
                                                                                pdfFactory.createHighlightAnnotation({
                                                                                                                page: 0,
                                                                                                                rect: [100, 100, 200, 200],
                                                                                                                contents: "Test123",
                                                                                                                author: "John",
                                                                                                                color: highlightAnnotColor,
                                                                                                                quadPoints: [100, 130, 150, 130, 100, 100, 150, 100 /*rectangle one*/, 150, 180, 200, 180, 150, 150, 200, 150 /*rectangle two*/],
                                                                                                                opacity: document.getElementById("highlightAnnotOpacity").value,
                                                                                                        })
                                                                        })

                                                document.querySelector('#addHighlightAnnotationQuadPointWithoutRect').addEventListener('click', (evt) => {
                                                                                pdfFactory.createHighlightAnnotation({
                                                                                                                page: 0,
                                                                                                                rect: [],
                                                                                                                contents: "Test123",
                                                                                                                author: "John",
                                                                                                                color: highlightAnnotColor,
                                                                                                                quadPoints: [100, 130, 150, 130, 100, 100, 150, 100 /*rectangle one*/, 150, 180, 200, 180, 150, 150, 200, 150 /*rectangle two*/],
                                                                                                                opacity: document.getElementById("highlightAnnotOpacity").value,
                                                                                                        })
                                                                        })

                                                document.querySelector('#addUnderlineAnnotation').addEventListener('click', (evt) => {
                                                                                pdfFactory.createUnderlineAnnotation({
                                                                                                                page: 0,
                                                                                                                rect: [50, 50, 80, 80],
                                                                                                                contents: "Test123",
                                                                                                                author: "John",
                                                                                                                color: highlightAnnotColor,
                                                                                                                opacity: document.getElementById("highlightAnnotOpacity").value,
                                                                                                        })
                                                                        })

                                                document.querySelector('#addSquigglyAnnotation').addEventListener('click', (evt) => {
                                                                                pdfFactory.createSquigglyAnnotation({
                                                                                                                page: 0,
                                                                                                                rect: [100, 100, 200, 200],
                                                                                                                contents: "Test123",
                                                                                                                author: "John",
                                                                                                                color: highlightAnnotColor,
                                                                                                                opacity: document.getElementById("highlightAnnotOpacity").value,
                                                                                                        })
                                                                        })

                                                document.querySelector('#addStrikeOutAnnotation').addEventListener('click', (evt) => {
                                                                                pdfFactory.createStrikeOutAnnotation({
                                                                                                                page: 0,
                                                                                                                rect: [100, 100, 200, 200],
                                                                                                                contents: "Test123",
                                                                                                                author: "John",
                                                                                                                color: highlightAnnotColor,
                                                                                                                opacity: document.getElementById("highlightAnnotOpacity").value,
                                                                                                        })
                                                                        })

                                                document.querySelector('#addFreeTextAnnotation').addEventListener('click', (evt) => {
                                                                                let textJustification = pdfAnnotate.TextJustification.Left
                                                                                let radios = document.getElementsByName("freetext_text_justification")


                                                                                if (radios[0].checked) {
                                                                                                                textJustification = pdfAnnotate.TextJustification.Left
                                                                                                        } else if (radios[1].checked) {
                                                                                                                                        textJustification = pdfAnnotate.TextJustification.Centered
                                                                                                                                } else if (radios[2].checked) {
                                                                                                                                                                textJustification = pdfAnnotate.TextJustification.Right
                                                                                                                                                        }

                                                                                let freeTextType = pdfAnnotate.FreeTextType.FreeText
                                                                                let calloutline = []

                                                                                radios = document.getElementsByName("freetext_type")

                                                                                if (radios[0].checked) {
                                                                                                                freeTextType = pdfAnnotate.FreeTextType.FreeText
                                                                                                        } else if (radios[1].checked) {
                                                                                                                                        freeTextType = pdfAnnotate.FreeTextType.FreeTextCallout
                                                                                                                                        calloutline = [20, 20, 40, 40]
                                                                                                                                } else if (radios[2].checked) {
                                                                                                                                                                freeTextType = pdfAnnotate.FreeTextType.FreeTextTypeWriter
                                                                                                                                                        }

                                                                                let lineEndingStyle = pdfAnnotate.LineEndingStyle.None

                                                                                radios = document.getElementsByName("freetext_callout_line_ending")

                                                                                if (radios[0].checked) {
                                                                                                                lineEndingStyle = pdfAnnotate.LineEndingStyle.Square
                                                                                                        } else if (radios[1].checked) {
                                                                                                                                        lineEndingStyle = pdfAnnotate.LineEndingStyle.Circle
                                                                                                                                } else if (radios[2].checked) {
                                                                                                                                                                lineEndingStyle = pdfAnnotate.LineEndingStyle.Diamond
                                                                                                                                                        } else if (radios[3].checked) {
                                                                                                                                                                                        lineEndingStyle = pdfAnnotate.LineEndingStyle.OpenArrow
                                                                                                                                                                                } else if (radios[4].checked) {
                                                                                                                                                                                                                lineEndingStyle = pdfAnnotate.LineEndingStyle.ClosedArrow
                                                                                                                                                                                                        } else if (radios[5].checked) {
                                                                                                                                                                                                                                        lineEndingStyle = pdfAnnotate.LineEndingStyle.None
                                                                                                                                                                                                                                } else if (radios[6].checked) {
                                                                                                                                                                                                                                                                lineEndingStyle = pdfAnnotate.LineEndingStyle.Butt
                                                                                                                                                                                                                                                        } else if (radios[7].checked) {
                                                                                                                                                                                                                                                                                        lineEndingStyle = pdfAnnotate.LineEndingStyle.ROpenArrow
                                                                                                                                                                                                                                                                                } else if (radios[8].checked) {
                                                                                                                                                                                                                                                                                                                lineEndingStyle = pdfAnnotate.LineEndingStyle.RClosedArrow
                                                                                                                                                                                                                                                                                                        } else if (radios[9].checked) {
                                                                                                                                                                                                                                                                                                                                        lineEndingStyle = pdfAnnotate.LineEndingStyle.Slash
                                                                                                                                                                                                                                                                                                                                }

                                                                                pdfFactory.createFreeTextAnnotation({
                                                                                                                page: 0,
                                                                                                                rect: [30, 30, 50, 50],
                                                                                                                contents: "Test123",
                                                                                                                author: "John",
                                                                                                                textJustification: textJustification,
                                                                                                                freeTextType: freeTextType,
                                                                                                                lineEndingStyle: lineEndingStyle,
                                                                                                                calloutLine: calloutline
                                                                                                        })
                                                                        })

                                                document.querySelector('#addLineAnnotation').addEventListener('click', (evt) => {
                                                                                pdfFactory.createLineAnnotation(0, [70, 70, 90, 90], "Test123", "John")
                                                                        })

                                                document.querySelector('#addCircleAnnotation').addEventListener('click', (evt) => {
                                                                                pdfFactory.createCircleAnnotation({
                                                                                                                page: 0,
                                                                                                                rect: [60, 60, 80, 80],
                                                                                                                contents: "Test123",
                                                                                                                author: "John",
                                                                                                                color: lineColor,
                                                                                                                fill: fillColor
                                                                                                        })
                                                                        })

                                                document.querySelector('#addSquareAnnotation').addEventListener('click', (evt) => {
                                                                                pdfFactory.createSquareAnnotation({
                                                                                                                page: 0,
                                                                                                                //rect: [478.55, 207.57, 558.55, 232.57],
                                                                                                                rect: [178.55, 107.57, 158.55, 132.57],
                                                                                                                contents: "",
                                                                                                                author: "",
                                                                                                                color: {r:10,g:50,b:30},
                                                                                                                fill: {r:150,g:200,b:20}
                                                                                                        })
                                                                        })

                                                document.querySelector('#addPolygonAnnotation').addEventListener('click', (evt) => {
                                                                                pdfFactory.createPolygonAnnotation({
                                                                                                                page: 0,
                                                                                                                rect: [80, 80, 120, 120],
                                                                                                                contents: "Test123",
                                                                                                                author: "John",
                                                                                                                vertices: [80, 80, 100, 100, 110, 80, 120, 120],
                                                                                                                color: lineColor,
                                                                                                                fill: fillColor
                                                                                                        })
                                                                        })

                                                document.querySelector('#addPolyLineAnnotation').addEventListener('click', (evt) => {
                                                                                let lineStart = pdfAnnotate.LineEndingStyle.None
                                                                                let lineEnd = pdfAnnotate.LineEndingStyle.None

                                                                                radios = document.getElementsByName("polyline_line_start")

                                                                                if (radios[0].checked) {
                                                                                                                lineStart = pdfAnnotate.LineEndingStyle.Square
                                                                                                        } else if (radios[1].checked) {
                                                                                                                                        lineStart = pdfAnnotate.LineEndingStyle.Circle
                                                                                                                                } else if (radios[2].checked) {
                                                                                                                                                                lineStart = pdfAnnotate.LineEndingStyle.Diamond
                                                                                                                                                        } else if (radios[3].checked) {
                                                                                                                                                                                        lineStart = pdfAnnotate.LineEndingStyle.OpenArrow
                                                                                                                                                                                } else if (radios[4].checked) {
                                                                                                                                                                                                                lineStart = pdfAnnotate.LineEndingStyle.ClosedArrow
                                                                                                                                                                                                        } else if (radios[5].checked) {
                                                                                                                                                                                                                                        lineStart = pdfAnnotate.LineEndingStyle.None
                                                                                                                                                                                                                                } else if (radios[6].checked) {
                                                                                                                                                                                                                                                                lineStart = pdfAnnotate.LineEndingStyle.Butt
                                                                                                                                                                                                                                                        } else if (radios[7].checked) {
                                                                                                                                                                                                                                                                                        lineStart = pdfAnnotate.LineEndingStyle.ROpenArrow
                                                                                                                                                                                                                                                                                } else if (radios[8].checked) {
                                                                                                                                                                                                                                                                                                                lineStart = pdfAnnotate.LineEndingStyle.RClosedArrow
                                                                                                                                                                                                                                                                                                        } else if (radios[9].checked) {
                                                                                                                                                                                                                                                                                                                                        lineStart = pdfAnnotate.LineEndingStyle.Slash
                                                                                                                                                                                                                                                                                                                                }

                                                                                radios = document.getElementsByName("polyline_line_end")

                                                                                if (radios[0].checked) {
                                                                                                                lineEnd = pdfAnnotate.LineEndingStyle.Square
                                                                                                        } else if (radios[1].checked) {
                                                                                                                                        lineEnd = pdfAnnotate.LineEndingStyle.Circle
                                                                                                                                } else if (radios[2].checked) {
                                                                                                                                                                lineEnd = pdfAnnotate.LineEndingStyle.Diamond
                                                                                                                                                        } else if (radios[3].checked) {
                                                                                                                                                                                        lineEnd = pdfAnnotate.LineEndingStyle.OpenArrow
                                                                                                                                                                                } else if (radios[4].checked) {
                                                                                                                                                                                                                lineEnd = pdfAnnotate.LineEndingStyle.ClosedArrow
                                                                                                                                                                                                        } else if (radios[5].checked) {
                                                                                                                                                                                                                                        lineEnd = pdfAnnotate.LineEndingStyle.None
                                                                                                                                                                                                                                } else if (radios[6].checked) {
                                                                                                                                                                                                                                                                lineEnd = pdfAnnotate.LineEndingStyle.Butt
                                                                                                                                                                                                                                                        } else if (radios[7].checked) {
                                                                                                                                                                                                                                                                                        lineEnd = pdfAnnotate.LineEndingStyle.ROpenArrow
                                                                                                                                                                                                                                                                                } else if (radios[8].checked) {
                                                                                                                                                                                                                                                                                                                lineEnd = pdfAnnotate.LineEndingStyle.RClosedArrow
                                                                                                                                                                                                                                                                                                        } else if (radios[9].checked) {
                                                                                                                                                                                                                                                                                                                                        lineEnd = pdfAnnotate.LineEndingStyle.Slash
                                                                                                                                                                                                                                                                                                                                }
                                                                                pdfFactory.createPolyLineAnnotation({
                                                                                                                page: 0,
                                                                                                                rect: [80, 80, 120, 120],
                                                                                                                contents: "Test123",
                                                                                                                author: "John",
                                                                                                                vertices: [80, 80, 100, 100, 110, 80, 120, 120],
                                                                                                                color: lineColor,
                                                                                                                fill: fillColor,
                                                                                                                lineEndingStyles: [lineStart, lineEnd]
                                                                                                        })
                                                                        })

                                                document.querySelector('#addInkAnnotation').addEventListener('click', (evt) => {
                                                                                const ink1 = pdfFactory.createInkAnnotation({
                                                                                                                page: 0,
                                                                                                                rect: [405.8170931339264, 474.293363571167, 483.5570912361145, 586.7734293937683],
                                                                                                                contents: "Test123",
                                                                                                                author: "John",
                                                                                                                inkList: [
                                                                                                                        [
    415.3703308105469,
    569.7188110351562,
    415.3703308105469,
    570.5084838867188,
    416.1600036621094,
    570.5084838867188,
    416.9496765136719,
    570.9032592773438,
    417.7393493652344,
    571.298095703125,
    418.5290222167969,
    571.6929321289062,
    419.71356201171875,
    572.0877685546875,
    422.4774169921875,
    573.272216796875,
    423.66192626953125,
    573.6669921875,
    427.6103210449219,
    574.4566650390625,
    429.1896667480469,
    574.8514404296875,
    433.927734375,
    575.2462768554688,
    439.4554748535156,
    575.6410522460938,
    441.4296875,
    576.035888671875,
    449.7213134765625,
    576.4307250976562,
    452.8800048828125,
    576.4307250976562,
    455.64385986328125,
    576.8255004882812,
    462.35614013671875,
    577.6151733398438,
    465.51483154296875,
    578.0099487304688,
    470.6477355957031,
    579.1943969726562,
    472.2270812988281,
    579.1943969726562,
    473.4115905761719,
    579.5892333984375,
    474.5960998535156,
    579.5892333984375
],
[
    413.0013122558594,
    571.6929321289062,
    413.3961486816406,
    570.9032592773438,
    414.5806579589844,
    567.7447509765625,
    418.1341857910156,
    559.8484497070312,
    421.29290771484375,
    551.1625366210938,
    424.45159912109375,
    544.0558471679688,
    426.0309753417969,
    538.5284423828125,
    428.0051574707031,
    533.0009765625,
    432.74322509765625,
    520.76171875,
    433.927734375,
    516.8135375976562,
    435.90191650390625,
    510.8913269042969,
    437.48126220703125,
    505.3639221191406,
    438.2709655761719,
    501.810546875,
    439.4554748535156,
    497.8624267578125,
    440.6400146484375,
    493.1246337890625,
    441.03485107421875,
    488.3868408203125,
    441.4296875,
    485.22833251953125,
    441.4296875,
    483.2542419433594,
    441.4296875,
    482.0697937011719,
    441.4296875,
    480.8853454589844
],
[
    426.8206481933594,
    525.49951171875,
    427.6103210449219,
    526.2891235351562,
    433.1380615234375,
    528.6580200195312,
    438.2709655761719,
    531.0269165039062,
    444.5884094238281,
    534.5802612304688,
    451.3006591796875,
    537.3439331054688,
    457.6180725097656,
    540.107666015625,
    466.30450439453125,
    543.2661743164062,
    469.4632263183594,
    544.0558471679688,
    474.5960998535156,
    544.845458984375,
    475.7806396484375,
    544.845458984375,
    476.96514892578125,
    544.845458984375
]
                                                                                                                ],
                                                                                                                lines: [
                                                                                                                        [
                                                                                                                        null,
                                                                                                                        null,
                                                                                                                        null,
                                                                                                                        null,
                                                                                                                        415.3703308105469,
                                                                                                                        569.7188110351562,
                                                                                                                        415.3703308105469,
                                                                                                                        570.3768920898438,
                                                                                                                        415.501953125,
                                                                                                                        570.5084838867188,
                                                                                                                        415.7651672363281,
                                                                                                                        570.5084838867188,
                                                                                                                        416.02838134765625,
                                                                                                                        570.5084838867188,
                                                                                                                        416.2916259765625,
                                                                                                                        570.5742797851562,
                                                                                                                        416.5548400878906,
                                                                                                                        570.7058715820312,
                                                                                                                        416.81805419921875,
                                                                                                                        570.8375244140625,
                                                                                                                        417.081298828125,
                                                                                                                        570.9691162109375,
                                                                                                                        417.3445129394531,
                                                                                                                        571.1007080078125,
                                                                                                                        417.6077575683594,
                                                                                                                        571.2322998046875,
                                                                                                                        417.8709716796875,
                                                                                                                        571.3638916015625,
                                                                                                                        418.1341857910156,
                                                                                                                        571.4954833984375,
                                                                                                                        418.3974304199219,
                                                                                                                        571.6271362304688,
                                                                                                                        418.7264404296875,
                                                                                                                        571.7587280273438,
                                                                                                                        419.12127685546875,
                                                                                                                        571.8903198242188,
                                                                                                                        419.5161437988281,
                                                                                                                        572.0219116210938,
                                                                                                                        420.1741943359375,
                                                                                                                        572.28515625,
                                                                                                                        421.0954895019531,
                                                                                                                        572.679931640625,
                                                                                                                        422.01678466796875,
                                                                                                                        573.0747680664062,
                                                                                                                        422.6748352050781,
                                                                                                                        573.3380126953125,
                                                                                                                        423.0696716308594,
                                                                                                                        573.4696044921875,
                                                                                                                        423.4645080566406,
                                                                                                                        573.6011962890625,
                                                                                                                        424.32000732421875,
                                                                                                                        573.798583984375,
                                                                                                                        425.6361389160156,
                                                                                                                        574.0618286132812,
                                                                                                                        426.9522399902344,
                                                                                                                        574.3250122070312,
                                                                                                                        427.87353515625,
                                                                                                                        574.5224609375,
                                                                                                                        428.3999938964844,
                                                                                                                        574.654052734375,
                                                                                                                        428.92645263671875,
                                                                                                                        574.78564453125,
                                                                                                                        429.9793395996094,
                                                                                                                        574.917236328125,
                                                                                                                        431.5586853027344,
                                                                                                                        575.048828125,
                                                                                                                        433.1380615234375,
                                                                                                                        575.1804809570312,
                                                                                                                        434.8490295410156,
                                                                                                                        575.3120727539062,
                                                                                                                        436.69158935546875,
                                                                                                                        575.4436645507812,
                                                                                                                        438.5341796875,
                                                                                                                        575.5752563476562,
                                                                                                                        439.78448486328125,
                                                                                                                        575.7069091796875,
                                                                                                                        440.4425964355469,
                                                                                                                        575.8385009765625,
                                                                                                                        441.10064697265625,
                                                                                                                        575.9700927734375,
                                                                                                                        442.8116149902344,
                                                                                                                        576.1016845703125,
                                                                                                                        445.57550048828125,
                                                                                                                        576.2332763671875,
                                                                                                                        448.33935546875,
                                                                                                                        576.3649291992188,
                                                                                                                        450.24774169921875,
                                                                                                                        576.4307250976562,
                                                                                                                        451.3006591796875,
                                                                                                                        576.4307250976562,
                                                                                                                        452.3535461425781,
                                                                                                                        576.4307250976562,
                                                                                                                        453.34063720703125,
                                                                                                                        576.4965209960938,
                                                                                                                        454.2619323730469,
                                                                                                                        576.6281127929688,
                                                                                                                        455.1832275390625,
                                                                                                                        576.7597045898438,
                                                                                                                        456.7625732421875,
                                                                                                                        576.9571533203125,
                                                                                                                        459,
                                                                                                                        577.2203369140625,
                                                                                                                        461.2374267578125,
                                                                                                                        577.4835205078125,
                                                                                                                        462.882568359375,
                                                                                                                        577.6809692382812,
                                                                                                                        463.93548583984375,
                                                                                                                        577.8125610351562,
                                                                                                                        464.9883728027344,
                                                                                                                        577.9441528320312,
                                                                                                                        466.37030029296875,
                                                                                                                        578.2073974609375,
                                                                                                                        468.0812683105469,
                                                                                                                        578.6021728515625,
                                                                                                                        469.792236328125,
                                                                                                                        578.9970092773438,
                                                                                                                        470.91094970703125,
                                                                                                                        579.1943969726562,
                                                                                                                        471.4374084472656,
                                                                                                                        579.1943969726562,
                                                                                                                        471.9638671875,
                                                                                                                        579.1943969726562,
                                                                                                                        472.42449951171875,
                                                                                                                        579.2601928710938,
                                                                                                                        472.8193359375,
                                                                                                                        579.391845703125,
                                                                                                                        473.21417236328125,
                                                                                                                        579.5234375,
                                                                                                                        473.6090087890625,
                                                                                                                        579.5892333984375,
                                                                                                                        474.00384521484375,
                                                                                                                        579.5892333984375
                                                                                                                        ],
                                                                                                                        [
                                                                                                                        null,
                                                                                                                        null,
                                                                                                                        null,
                                                                                                                        null,
                                                                                                                        413.0013122558594,
                                                                                                                        571.6929321289062,
                                                                                                                        413.330322265625,
                                                                                                                        571.034912109375,
                                                                                                                        413.59356689453125,
                                                                                                                        570.3768920898438,
                                                                                                                        413.9884033203125,
                                                                                                                        569.3240356445312,
                                                                                                                        414.38323974609375,
                                                                                                                        568.2711791992188,
                                                                                                                        415.17291259765625,
                                                                                                                        566.4287109375,
                                                                                                                        416.357421875,
                                                                                                                        563.796630859375,
                                                                                                                        417.54193115234375,
                                                                                                                        561.1644897460938,
                                                                                                                        418.66064453125,
                                                                                                                        558.4008178710938,
                                                                                                                        419.71356201171875,
                                                                                                                        555.5054931640625,
                                                                                                                        420.7664489746094,
                                                                                                                        552.6101684570312,
                                                                                                                        421.8193664550781,
                                                                                                                        549.9780883789062,
                                                                                                                        422.87225341796875,
                                                                                                                        547.6091918945312,
                                                                                                                        423.9251708984375,
                                                                                                                        545.2402954101562,
                                                                                                                        424.71484375,
                                                                                                                        543.1345825195312,
                                                                                                                        425.24127197265625,
                                                                                                                        541.2921142578125,
                                                                                                                        425.7677307128906,
                                                                                                                        539.4496459960938,
                                                                                                                        426.3599853515625,
                                                                                                                        537.607177734375,
                                                                                                                        427.01806640625,
                                                                                                                        535.7647094726562,
                                                                                                                        427.6761169433594,
                                                                                                                        533.9222412109375,
                                                                                                                        428.7948303222656,
                                                                                                                        530.9611206054688,
                                                                                                                        430.3741760253906,
                                                                                                                        526.88134765625,
                                                                                                                        431.95355224609375,
                                                                                                                        522.8015747070312,
                                                                                                                        432.9406433105469,
                                                                                                                        520.1036987304688,
                                                                                                                        433.3354797363281,
                                                                                                                        518.7876586914062,
                                                                                                                        433.7303161621094,
                                                                                                                        517.4715576171875,
                                                                                                                        434.25677490234375,
                                                                                                                        515.8265380859375,
                                                                                                                        434.9148254394531,
                                                                                                                        513.8524169921875,
                                                                                                                        435.5728759765625,
                                                                                                                        511.87835693359375,
                                                                                                                        436.1651611328125,
                                                                                                                        509.9700927734375,
                                                                                                                        436.69158935546875,
                                                                                                                        508.12762451171875,
                                                                                                                        437.2180480957031,
                                                                                                                        506.2851257324219,
                                                                                                                        437.6128845214844,
                                                                                                                        504.77166748046875,
                                                                                                                        437.8760986328125,
                                                                                                                        503.5872497558594,
                                                                                                                        438.13934326171875,
                                                                                                                        502.4028015136719,
                                                                                                                        438.4683837890625,
                                                                                                                        501.1525573730469,
                                                                                                                        438.86322021484375,
                                                                                                                        499.83648681640625,
                                                                                                                        439.258056640625,
                                                                                                                        498.5204162597656,
                                                                                                                        439.65289306640625,
                                                                                                                        497.0727844238281,
                                                                                                                        440.0477600097656,
                                                                                                                        495.4935302734375,
                                                                                                                        440.4425964355469,
                                                                                                                        493.9142761230469,
                                                                                                                        440.705810546875,
                                                                                                                        492.3349914550781,
                                                                                                                        440.8374328613281,
                                                                                                                        490.7557373046875,
                                                                                                                        440.96905517578125,
                                                                                                                        489.17645263671875,
                                                                                                                        441.10064697265625,
                                                                                                                        487.86041259765625,
                                                                                                                        441.2322692871094,
                                                                                                                        486.8075866699219,
                                                                                                                        441.3638916015625,
                                                                                                                        485.7547302246094,
                                                                                                                        441.4296875,
                                                                                                                        484.8993225097656,
                                                                                                                        441.4296875,
                                                                                                                        484.24127197265625,
                                                                                                                        441.4296875,
                                                                                                                        483.583251953125,
                                                                                                                        441.4296875,
                                                                                                                        483.05682373046875,
                                                                                                                        441.4296875,
                                                                                                                        482.6620178222656,
                                                                                                                        441.4296875,
                                                                                                                        482.2671813964844,
                                                                                                                        441.4296875,
                                                                                                                        481.87237548828125,
                                                                                                                        441.4296875,
                                                                                                                        481.4775695800781
                                                                                                                        ],
                                                                                                                        [
                                                                                                                        null,
                                                                                                                        null,
                                                                                                                        null,
                                                                                                                        null,
                                                                                                                        426.8206481933594,
                                                                                                                        525.49951171875,
                                                                                                                        427.47869873046875,
                                                                                                                        526.1575317382812,
                                                                                                                        428.5316162109375,
                                                                                                                        526.6839599609375,
                                                                                                                        430.3741760253906,
                                                                                                                        527.4735717773438,
                                                                                                                        432.2167663574219,
                                                                                                                        528.2632446289062,
                                                                                                                        433.9935302734375,
                                                                                                                        529.0528564453125,
                                                                                                                        435.7044982910156,
                                                                                                                        529.8424682617188,
                                                                                                                        437.41546630859375,
                                                                                                                        530.632080078125,
                                                                                                                        439.3238525390625,
                                                                                                                        531.619140625,
                                                                                                                        441.4296875,
                                                                                                                        532.8035888671875,
                                                                                                                        443.5354919433594,
                                                                                                                        533.988037109375,
                                                                                                                        445.7071228027344,
                                                                                                                        535.0408935546875,
                                                                                                                        447.94451904296875,
                                                                                                                        535.9620971679688,
                                                                                                                        450.18194580078125,
                                                                                                                        536.8833618164062,
                                                                                                                        452.3535461425781,
                                                                                                                        537.8045654296875,
                                                                                                                        454.4593505859375,
                                                                                                                        538.725830078125,
                                                                                                                        456.5651550292969,
                                                                                                                        539.6470336914062,
                                                                                                                        459.0657958984375,
                                                                                                                        540.6340942382812,
                                                                                                                        461.9612731933594,
                                                                                                                        541.6869506835938,
                                                                                                                        464.8567810058594,
                                                                                                                        542.73974609375,
                                                                                                                        466.8309631347656,
                                                                                                                        543.3978271484375,
                                                                                                                        467.88385009765625,
                                                                                                                        543.6610107421875,
                                                                                                                        468.936767578125,
                                                                                                                        543.9241943359375,
                                                                                                                        470.3186950683594,
                                                                                                                        544.1874389648438,
                                                                                                                        472.0296630859375,
                                                                                                                        544.4506225585938,
                                                                                                                        473.7406311035156,
                                                                                                                        544.7138671875,
                                                                                                                        474.79351806640625,
                                                                                                                        544.845458984375,
                                                                                                                        475.1883850097656,
                                                                                                                        544.845458984375,
                                                                                                                        475.5832214355469,
                                                                                                                        544.845458984375,
                                                                                                                        475.9780578613281,
                                                                                                                        544.845458984375,
                                                                                                                        476.3728942871094,
                                                                                                                        544.845458984375
                                                                                                                        ]
                                                                                                                ],
                                                                                                                opacity: 0.9,
                                                                                                                color: { r: 0, g: 0, b: 1 },
                                                                                                                linecap: "round",
                                                                                                                linejoin: "round",
                                                                                                                miterlimit: 10,
                                                                                                                strokeWidth: 12,
                                                                                                                createDefaultAppearanceStream: true,
                                                                                                        })
                                                                                // ink1.createDefaultAppearanceStream();
                                                                        })

                                                document.querySelector('#addFreeHighlightAnnotation').addEventListener('click', (evt) => {
                                                                                const annot = pdfFactory.createFreeHighlightAnnotation({

                                                                                                                page: 0,
                                                                                                                rect: [
                                                                                                                        428.04633808135986, 465.84317886829376, 607.9681731462479, 604.113153219223,
                                                                                                                ],
                                                                                                                contents: "Test_free_highlight",
                                                                                                                author: "F",
                                                                                                                inkList: [
                                                                                                                        [
                                                                                                                                445.8750305175781, 484.5, 442.875, 501.75, 441.375, 514.5, 440.625,
                                                                                                                                537.75, 442.875, 554.25, 447.375, 569.25, 452.625, 583.5, 455.625,
                                                                                                                                595.5, 458.625, 606, 469.8750305175781, 597, 472.875, 594.75, 478.125,
                                                                                                                                589.5, 487.875, 576, 499.125, 555, 519.375, 512.25, 537.375, 487.5,
                                                                                                                                544.875, 476.25, 553.125, 464.25, 532.125, 471, 517.125, 478.5, 503.625,
                                                                                                                                483.75, 484.1250305175781, 492.75, 472.1249694824219, 498, 461.625, 501,
                                                                                                                                445.8750305175781, 504.75, 433.8749694824219, 505.5, 423.375, 505.5,
                                                                                                                                417.375, 505.5, 490.875, 517.5, 541.875, 525, 583.875, 534, 602.625,
                                                                                                                                538.5, 605.625, 538.5, 606.375, 539.25,
                                                                                                                        ],
                                                                                                                ],
                                                                                                                color: { r: 255, g: 255, b: 152 },
                                                                                                        });
                                                                                annot.createDefaultAppearanceStream();
                                                                        })

                                                document.querySelector('#download').addEventListener('click', (evt) => {
                                                                                pdfFactory.download()
                                                                        })

                                                document.querySelector('#showAnnotations').addEventListener('click', (evt) => {
                                                                                pdfFactory.getAnnotations().then( (data) => {
                                                                                                                console.log(data)
                                                                                                                document.querySelector('#app').innerHTML = data[0].map(d => d.type)
                                                                                                                //data[0][17].appearanceStream.lookupNContentStream()
                                                                                                                let fta = pdfFactory.createUnderlineAnnotation({
                                                                                                                                                page: 0,
                                                                                                                                                rect: [50, 50, 80, 80],
                                                                                                                                                contents: "Test123",
                                                                                                                                                author: "John",
                                                                                                                                                color: highlightAnnotColor,
                                                                                                                                                opacity: document.getElementById("highlightAnnotOpacity").value,
                                                                                                                                        })
                                                                                                                //                       let fta = pdfFactory.createFreeTextAnnotation({
                                                                                                                //                                                       page: 0,
                                                                                                                //                                                       rect: [30, 30, 50, 50],
                                                                                                                //                                                       contents: "Test123",
                                                                                                                //                                                       author: "John"
                                                                                                                //                                               })
                                                                                                                fta.createDefaultAppearanceStream()
                                                                                                        })
                                                                        })

                                                document.querySelector('#reloadFile').addEventListener('click', (evt) => {
                                                                                console.log("reload file")
                                                                                fileLoad(document.getElementById("inputFileName").value)
                                                                        })

                                                window.onload =  function(){
                                                                                fileLoad(document.getElementById("inputFileName").value)
                                                                        }
                </script>
        </body>
</html>
